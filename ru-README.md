# grpc-gnet-example

## Описание

Данный проект демонстрирует реализацию gRPC сервера с использованием высокопроизводительной сетевой библиотеки [gnet](https://github.com/panjf2000/gnet).

## Особенности

- Реализация HTTP/2 протокола для gRPC без использования стандартной библиотеки net/http
- Обработка gRPC запросов через неблокирующий ввод/вывод с помощью gnet
- Высокая производительность и низкое потребление ресурсов
- Поддержка метрик Prometheus
- Масштабирование на несколько ядер процессора

## Как это работает

Сервер реализует простой эхо-сервис, определенный в protobuf. Когда клиент отправляет сообщение, сервер отвечает, добавляя префикс "Echo: " к полученному сообщению.

Основные компоненты:

- Обработка HTTP/2 preface
- Работа с фреймами HTTP/2 (SETTINGS, HEADERS, DATA и т.д.)
- Кодирование и декодирование HPACK для заголовков
- Обработка gRPC потоков (streams)
- Сериализация и десериализация protobuf сообщений

## Запуск сервера

```bash
go run main.go --port=9080 --multicore=true --eventloops=4 --metrics-port=8081
```

### Параметры запуска

- `port` - порт для gRPC сервера (по умолчанию 9080)
- `multicore` - использование нескольких ядер процессора (по умолчанию true)
- `eventloops` - количество циклов событий (по умолчанию 4)
- `metrics-port` - порт для метрик Prometheus (по умолчанию 8081)

## Производительность

Данная реализация обеспечивает высокую производительность благодаря:

- Использованию пула буферов для уменьшения нагрузки на GC
- Асинхронному вводу/выводу через gnet
- Пулу горутин для обработки запросов

## Метрики

Сервер экспортирует метрики Prometheus по адресу `http://localhost:8081/`